# æ—¥èªŒé…ç½®æ–‡ä»¶
# å®Œæ•´çš„åˆ†ç´šæ—¥èªŒè¨˜éŒ„ç³»çµ±

version: 1
disable_existing_loggers: false

# ==================== æ ¼å¼åŒ–å™¨ ====================
formatters:
  standard:
    format: '%(asctime)s - %(name)s - %(levelname)s - %(message)s'
    datefmt: '%Y-%m-%d %H:%M:%S'
  
  detailed:
    format: '%(asctime)s - %(name)s - %(levelname)s - %(module)s - %(funcName)s:%(lineno)d - %(message)s'
    datefmt: '%Y-%m-%d %H:%M:%S'
  
  json_format:
    format: '{"timestamp": "%(asctime)s", "logger": "%(name)s", "level": "%(levelname)s", "module": "%(module)s", "function": "%(funcName)s", "line": %(lineno)d, "message": "%(message)s"}'
    datefmt: '%Y-%m-%d %H:%M:%S'
  
  trading_format:
    format: '%(asctime)s [%(levelname)s] ğŸ“Š %(name)s: %(message)s'
    datefmt: '%Y-%m-%d %H:%M:%S'
  
  error_format:
    format: '%(asctime)s âŒ [ERROR] %(name)s.%(funcName)s:%(lineno)d - %(message)s'
    datefmt: '%Y-%m-%d %H:%M:%S'

# ==================== è™•ç†å™¨ ====================
handlers:
  # æ§åˆ¶å°è¼¸å‡º
  console:
    class: logging.StreamHandler
    level: INFO
    formatter: trading_format
    stream: ext://sys.stdout
  
  # ç³»çµ±æ—¥èªŒæ–‡ä»¶
  system_file:
    class: logging.handlers.RotatingFileHandler
    level: DEBUG
    formatter: detailed
    filename: logs/system/system.log
    maxBytes: 10485760  # 10MB
    backupCount: 10
    encoding: utf8
  
  # äº¤æ˜“æ—¥èªŒæ–‡ä»¶
  trading_file:
    class: logging.handlers.RotatingFileHandler
    level: INFO
    formatter: json_format
    filename: logs/trading/trading.log
    maxBytes: 52428800  # 50MB
    backupCount: 20
    encoding: utf8
  
  # éŒ¯èª¤æ—¥èªŒæ–‡ä»¶
  error_file:
    class: logging.handlers.RotatingFileHandler
    level: ERROR
    formatter: error_format
    filename: logs/system/errors.log
    maxBytes: 10485760  # 10MB
    backupCount: 30
    encoding: utf8
  
  # å„ªåŒ–æ—¥èªŒæ–‡ä»¶
  optimization_file:
    class: logging.handlers.RotatingFileHandler
    level: DEBUG
    formatter: detailed
    filename: logs/optimization/optimization.log
    maxBytes: 20971520  # 20MB
    backupCount: 15
    encoding: utf8
  
  # æ•¸æ“šæ—¥èªŒæ–‡ä»¶
  data_file:
    class: logging.handlers.TimedRotatingFileHandler
    level: INFO
    formatter: json_format
    filename: logs/system/data.log
    when: midnight
    interval: 1
    backupCount: 30
    encoding: utf8
  
  # æ€§èƒ½æ—¥èªŒæ–‡ä»¶
  performance_file:
    class: logging.handlers.RotatingFileHandler
    level: INFO
    formatter: json_format
    filename: logs/trading/performance.log
    maxBytes: 10485760  # 10MB
    backupCount: 12
    encoding: utf8
  
  # å¯©è¨ˆæ—¥èªŒæ–‡ä»¶ (ä¸è¼ªæ›¿)
  audit_file:
    class: logging.FileHandler
    level: INFO
    formatter: json_format
    filename: logs/system/audit.log
    encoding: utf8

# ==================== æ—¥èªŒè¨˜éŒ„å™¨ ====================
loggers:
  # æ ¹æ—¥èªŒè¨˜éŒ„å™¨
  root:
    level: INFO
    handlers: [console, system_file, error_file]
    propagate: false
  
  # äº¤æ˜“ç³»çµ±æ—¥èªŒ
  trading:
    level: INFO
    handlers: [console, trading_file, error_file]
    propagate: false
    qualname: trading
  
  # æ•¸æ“šæ”¶é›†æ—¥èªŒ
  data_collector:
    level: DEBUG
    handlers: [console, data_file, error_file]
    propagate: false
    qualname: data_collector
  
  # ç‰¹å¾µå·¥ç¨‹æ—¥èªŒ
  feature_engineering:
    level: INFO
    handlers: [console, system_file, error_file]
    propagate: false
    qualname: feature_engineering
  
  # æ¨¡å‹è¨“ç·´æ—¥èªŒ
  model_training:
    level: INFO
    handlers: [console, optimization_file, error_file]
    propagate: false
    qualname: model_training
  
  # å›æ¸¬ç³»çµ±æ—¥èªŒ
  backtesting:
    level: INFO
    handlers: [console, system_file, error_file]
    propagate: false
    qualname: backtesting
  
  # å„ªåŒ–ç³»çµ±æ—¥èªŒ
  optimization:
    level: DEBUG
    handlers: [optimization_file, error_file]
    propagate: false
    qualname: optimization
  
  # é¢¨éšªç®¡ç†æ—¥èªŒ
  risk_management:
    level: INFO
    handlers: [console, trading_file, error_file]
    propagate: false
    qualname: risk_management
  
  # APIç³»çµ±æ—¥èªŒ
  api:
    level: INFO
    handlers: [console, system_file, error_file]
    propagate: false
    qualname: api
  
  # ç›£æ§ç³»çµ±æ—¥èªŒ
  monitoring:
    level: INFO
    handlers: [console, performance_file, error_file]
    propagate: false
    qualname: monitoring
  
  # æ•¸æ“šåº«æ“ä½œæ—¥èªŒ
  database:
    level: WARNING
    handlers: [system_file, error_file]
    propagate: false
    qualname: database
  
  # å¤–éƒ¨APIæ—¥èªŒ
  external_apis:
    level: WARNING
    handlers: [data_file, error_file]
    propagate: false
    qualname: external_apis
  
  # å®‰å…¨å¯©è¨ˆæ—¥èªŒ
  security:
    level: INFO
    handlers: [audit_file, error_file]
    propagate: false
    qualname: security
  
  # Telegramé€šçŸ¥æ—¥èªŒ
  telegram:
    level: INFO
    handlers: [system_file, error_file]
    propagate: false
    qualname: telegram
  
  # WebSocketé€£æ¥æ—¥èªŒ
  websocket:
    level: INFO
    handlers: [system_file, error_file]
    propagate: false
    qualname: websocket

# ==================== ç‰¹æ®Šé…ç½® ====================
special_configs:
  # äº¤æ˜“ä¿¡è™Ÿç‰¹æ®Šæ ¼å¼
  trading_signals:
    format: '%(asctime)s ğŸš¨ [SIGNAL] %(symbol)s: %(action)s @ %(price)s (Confidence: %(confidence).2f)'
    level: INFO
    
  # éŒ¯èª¤å‘Šè­¦æ ¼å¼
  error_alerts:
    format: '%(asctime)s âš ï¸ [ALERT] %(module)s: %(message)s'
    level: ERROR
    
  # æ€§èƒ½ç›£æ§æ ¼å¼
  performance_metrics:
    format: '%(asctime)s ğŸ“ˆ [METRICS] %(metric_name)s: %(metric_value)s'
    level: INFO

# ==================== éæ¿¾å™¨é…ç½® ====================
filters:
  # æ•æ„Ÿä¿¡æ¯éæ¿¾
  sensitive_filter:
    api_keys: ["api_key", "secret", "password", "token"]
    replacement: "***REDACTED***"
  
  # é »ç‡é™åˆ¶éæ¿¾
  rate_limit_filter:
    max_messages_per_minute: 100
    burst_size: 20

# ==================== æ—¥èªŒè¼ªæ›¿é…ç½® ====================
rotation_config:
  daily_rotation:
    when: "midnight"
    interval: 1
    backup_count: 30
    
  size_rotation:
    max_bytes: 10485760  # 10MB
    backup_count: 10
    
  weekly_rotation:
    when: "W0"  # Monday
    interval: 1
    backup_count: 12

# ==================== ç›£æ§å‘Šè­¦é…ç½® ====================
monitoring_alerts:
  error_threshold:
    max_errors_per_hour: 10
    alert_channels: ["telegram", "email"]
    
  performance_alerts:
    max_latency_ms: 1000
    min_success_rate: 0.95
    alert_channels: ["telegram"]
    
  disk_space_alerts:
    min_free_space_gb: 1
    alert_channels: ["telegram", "email"]

# ==================== é–‹ç™¼ç’°å¢ƒé…ç½® ====================
development:
  console_level: DEBUG
  file_level: DEBUG
  show_sql: true
  show_api_calls: true
  
# ==================== ç”Ÿç”¢ç’°å¢ƒé…ç½® ====================
production:
  console_level: WARNING
  file_level: INFO
  show_sql: false
  show_api_calls: false
  enable_audit: true
  
# ==================== æ¸¬è©¦ç’°å¢ƒé…ç½® ====================
testing:
  console_level: ERROR
  file_level: WARNING
  disable_external_logging: true
  mock_alerts: true

# ==================== æ—¥èªŒåˆ†æé…ç½® ====================
log_analysis:
  # ELK Stacké›†æˆ
  elasticsearch:
    enabled: false
    host: "localhost"
    port: 9200
    index_pattern: "crypto-trading-logs-*"
    
  # æ—¥èªŒèšåˆ
  aggregation:
    error_summary_interval: "1h"
    performance_summary_interval: "5m"
    trading_summary_interval: "1d"
    
  # æ—¥èªŒæ¸…ç†
  cleanup:
    max_age_days: 90
    compress_after_days: 7
    cleanup_schedule: "0 2 * * *"  # æ¯å¤©å‡Œæ™¨2é»
